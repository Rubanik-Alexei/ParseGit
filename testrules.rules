alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg: "CobaltStrike login server"; flow:established; content:"Cyberspace"; depth:200; content:"Somewhere"; distance:0; content:"cobaltstrike"; distance:0; content:"AdvancedPenTesting";distance:0; classtype:exploit-kit; sid:3016001; rev:1; metadata:by al0ne;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg: "CoballltStrike download.windowsupdate.com C2 Profile"; 
flow: established; content:"Msdownload"; 
http_uri; pcre:"/\/c\/msdownload\/update\/others\/[\d]{4}/\d{2}/\d{7,8}_[\d\w-_]{50,}\.cab/UR"; 
reference:url,github.com/bluscreenofjeff/MalleableC2Profiles/blob/master/microsoftupdate_getonly.profile; 
classtype:exploit-kit; sid: 3016002;
 rev: 1; metadata:created_at 2018_09_25,by al0ne; )
alert http any any -> any any (msg:"CobatlStrikte team servers 200 OK Space"; flow:from_server,established; 
content:"200"; http_stat_code; content:"HTTP/1.1 200 OK|20|"; threshold: type both, track by_src, count 4, seconds 60; reference:url,blog.fox-it.com/2019/02/26/identifying-cobalt-strike-team-servers-in-the-wild/;  sid:3016011; rev:1; metadata:created_at 2019_02_27,by al0ne;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg: "CobaltStrike HTTP beacon response"; flow: established; content:\"200\"; http_stat_code; content:!\"Server:\"; http_header; content:\"application/octet-stream\"; http_header; distance:0;  content:\"Content-Length: 0\"; http_header; distance:0; threshold: type both, track by_src, count 5, seconds 60; classtype:exploit-kit; sid: 3016003; rev: 1; metadata:created_at 2018_11_15,by al0ne;)
alert icmp any any -> any any (msg:"ICMP Tunnel Detection Of Type Zero"; 
icode:0; itype:0; content:!"|101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f3031323334353637|"; content:!"|6162636465666768696a6b6c6d6e6f7071727374757677616263646566676869|"; 
threshold: type both, track by_src, count 100, seconds 30; 
sid:3017038; rev:1;)
alert icmp any any -> any any (msg:"ICMP Tunnel Detection Of Type Eight"; icode:0; itype:8; 
content:!"|101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f3031323334353637|"; content:!"|6162636465666768696a6b6c6d6e6f7071727374757677616263646566676869|"; threshold: type both, track by_src, count 100, seconds 30; 
sid:3017037; rev:1;)
